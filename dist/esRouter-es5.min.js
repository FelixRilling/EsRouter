"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a,b){var c=function(){function b(a,c,d){_classCallCheck(this,b),this.sections=a,this.events={before:d.before,done:d.done,fail:d.fail,always:d.always},this.options={ajax:c.ajax|!1,log:c.log|!1},this.slug={preSlash:c.slug.preSlash|!1,postSlash:c.slug.postSlash|!1,urlFragmentInitator:"string"==typeof c.slug.urlFragmentInitator?c.slug.urlFragmentInitator:"#",urlFragmentAppend:"string"==typeof c.slug.urlFragmentAppend?c.slug.urlFragmentAppend:""},this.slug.full=(this.slug.preSlash?"/":"")+this.slug.urlFragmentInitator+this.slug.urlFragmentAppend,this.data={active:null,activeId:null,defaultId:null},"undefined"==typeof this.sections[0]&&this.throwError(0)}return _createClass(b,[{key:"init",value:function(){var a=this.findData(this.sections,"routerDefault","true");if(a){this.data.defaultId=a.dataset.routerId;var b=this.slugGet();this.writeLog("init",this.data.defaultId),this.moveTo(b)}else this.throwError(1)}},{key:"moveTo",value:function(a,b){this.callback(this.events.before,[a,this]),this.writeLog("move",a);var c=this.toggleActiveSection(a);return c?(this.slugSet(this.data.activeId),this.callback(this.events.done,[this.data.active,this.data.activeId,this.getCurrentIndex(),this])):b?this.throwError(2):(this.writeLog("warning",a+" not found"),this.moveTo(this.data.defaultId,!0)),this.callback(this.events.always,[this.data.active,this.data.activeId,this.getCurrentIndex(),this]),c}},{key:"moveForward",value:function(){this.moveBy(1)}},{key:"moveBackward",value:function(){this.moveBy(-1)}},{key:"moveBy",value:function(a){var b=this.getCurrentIndex();"undefined"!=typeof this.sections[b+a]&&this.moveTo(this.sections[b+a].dataset.routerId)}},{key:"toggleActiveSection",value:function(a){var b=this.findData(this.sections,"routerId",a);return"undefined"!=typeof b?(this.data.activeId=a,this.data.active=b,!0):!1}},{key:"slugGet",value:function(b){return this.slugIsSet()?a.href.substr(a.href.lastIndexOf(this.slug.full)+(this.slug.preSlash?2:1)):b?void this.throwError(3):(this.slugInit(this.data.defaultId),this.slugGet(!0))}},{key:"slugIsSet",value:function(){return a.href.lastIndexOf(this.slug.full)>-1}},{key:"slugSet",value:function(b){a.href=a.href.substr(0,a.href.lastIndexOf(this.slug.full)+this.slug.full.length)+b}},{key:"slugInit",value:function(b){a.href=a.href+this.slug.full+b}},{key:"getCurrentIndex",value:function(){return this.getElementIndex(this.sections,this.data.active)}},{key:"getElementIndex",value:function(a,b){var c=void 0;return this.iterateDomNode(a,function(a,d){a===b&&(c=d)}),c}},{key:"findData",value:function(a,b,c){var d=void 0;return this.iterateDomNode(a,function(a){a.dataset[b]===c&&(d=a)}),d}},{key:"iterateDomNode",value:function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)}},{key:"callback",value:function(a,b){"function"==typeof a&&a.apply(this,b)}},{key:"writeLog",value:function(a,b){this.options.log}},{key:"throwError",value:function(a){throw new Error("esRouter error: "+a)}}]),b}();b.esRouter=c}(location,window);