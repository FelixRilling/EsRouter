"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=a.location,c=function(){function a(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,a);var e=this;e.$e=d,e.options={ajax:c.ajax||!1,log:c.log||!1,autoBind:c.autoBind||!0},e.data={active:null,activeId:null,defaultId:null,index:0},c.slug=c.slug||{},e.$s={preSlash:c.slug.preSlash||!1,postSlash:c.slug.postSlash||!1,prepend:"string"==typeof c.slug.prepend?c.slug.prepend:"",append:"string"==typeof c.slug.append?c.slug.append:"",get:function(a,c){return e.$s.has()?b.href.substr(b.href.lastIndexOf(e.$s.built)+e.$s.built.length+(e.$s.preSlash?1:0)):void c(a)},has:function(){return b.href.lastIndexOf(e.$s.built)>-1},set:function(a){b.href=b.href.substr(0,b.href.lastIndexOf(e.$s.built)+e.$s.built.length)+a},create:function(a){b.href=b.href+e.$s.built+a},init:function(a,b){var c=e.$s.get(!1,function(b){return b?void a():(e.$s.create(e.data.defaultId),e.$s.get(!0))});b(c)},built:null},e.$s.built=(e.$s.preSlash?"/":"")+"#"+e.$s.prepend+e.$s.append,e.$d={corePrefix:c.dataPrefix||"router",built:{},elements:{},base:{field:"section",fieldDefault:"default",link:"href",pagination:"pagin",source:"src"},getElements:function(a,b){e.$u.eachObject(e.$d.base,function(b,c,d){var f=e.$d.buildAttr(e.$d.corePrefix,e.$d.base[c]);e.$d.built[c]=f,e.$d.elements[c]=document.querySelectorAll("["+f[0]+"]")||[],e.$u.isDefined(e.$d.elements[c])||a(e.$d.elements[c])}),b()},buildAttr:function(a,b){function c(a,b){return"data-"+a+"-"+b}function d(a,b){return a+b[0].toUpperCase()+b.substr(1)}return[c(a,b),d(a,b)]},bindNav:function(){function a(a,b){e.$u.each(a,function(a){a.addEventListener("click",b)})}a(e.$d.elements.link,function(a){e.moveTo(a.target.dataset[e.$d.built.link[1]])}),a(e.$d.elements.pagination,function(a){e.moveBy(parseInt(a.target.dataset[e.$d.built.pagination[1]]))})}},e.$r={init:function(a){e.$d.getElements(function(a){e.$u.log(1,0,1,a)},function(){e.$u.isDefined(e.$d.elements.fieldDefault)?(e.data.defaultId=e.$d.elements.fieldDefault[0].dataset[e.$d.built.field[1]],e.options.autoBind&&e.$d.bindNav(),e.$s.init(function(){e.$u.log(1,1,1,e)},function(a){e.moveTo(a)})):e.$u.log(0,0,0,e)})},move:function(a,b){function c(a,b,c){var d=e.$u.findData(e.$d.elements.field,e.$d.built.field[1],a);return e.$u.isDefined(d)?(e.data.activeId=a,e.data.active=d,e.data.index=e.getCurrentIndex(),c(),!0):(b(),!1)}var d=this;e.$u.callback(e.$e.before,[a,e]);var f=c(a,function(){b?(e.$u.callback(e.$e.fail,[a,e]),e.$u.log(0,1,1,d)):(e.$u.log(1,1,0,a),e.$r.move(e.data.defaultId,!0))},function(){e.$s.set(e.data.activeId),e.options.ajax?e.$u.getAJAX(e.data.active.dataset[e.$d.built.source[1]],function(a){e.data.active.innerHTML=a,e.$u.callback(e.$e.done,[e.data.active,e.data.activeId,e.data.index,e,a])}):e.$u.callback(e.$e.done,[e.data.active,e.data.activeId,e.data.index,e])});return e.$u.callback(e.$e.always,[e.data.active,e.data.activeId,e.data.index,e]),f}},e.$u={getElementIndex:function(a,b){var c=void 0;return e.$u.each(a,function(a,d){a===b&&(c=d)}),c},findData:function(a,b,c){var d=void 0;return e.$u.each(a,function(a){a.dataset[b]===c&&(d=a)}),d},each:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},eachObject:function(a,b){for(var c=Object.keys(a),d=0,e=c.length;d<e;d++)b(a[c[d]],c[d],d)},getAJAX:function(a,b){var c=new XMLHttpRequest;c.addEventListener("load",function(a){b(a.target.response)}),c.addEventListener("error",function(a){e.$u.log(1,3,0,c)}),c.open("GET",a),c.send()},callback:function(a,b){if("function"==typeof a)return a.apply(this,b)},isDefined:function(a){return"undefined"!=typeof a},log:function(a,b,c,d){var f="esRouter: "+a+": "+b+"=>"+c+"= "+d;if(0===a)throw f;e.options.log}}}return _createClass(a,[{key:"init",value:function(){return this.$r.init(),this}},{key:"moveTo",value:function(a){return this.$r.move(a,!1),this}},{key:"moveBy",value:function(a){var b=this,c=b.data.index+a;return b.$u.isDefined(b.$d.elements.field[c])?b.$r.move(b.$d.elements.field[c].dataset[b.$d.built.field[1]]):b.$u.log(2,1,0,a),b}},{key:"moveForward",value:function(){return this.moveBy(1)}},{key:"moveBackward",value:function(){return this.moveBy(-1)}},{key:"getCurrentIndex",value:function(){return this.$u.getElementIndex(this.$d.elements.field,this.data.active)}}]),a}();a.esRouter=c}(window);