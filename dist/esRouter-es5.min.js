"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=a.location;a.esRouter=function(){function a(b,c,d){_classCallCheck(this,a);var e=this;e.sections=b,e.events={before:d.before,done:d.done,fail:d.fail,always:d.always},e.options={ajax:c.ajax,log:c.log},e.options=c|{slug:c.slug|{},domAttr:c.domAttr|{}},e.slug={preSlash:c.slug.preSlash,postSlash:c.slug.postSlash,urlFragmentInitator:"string"==typeof c.slug.urlFragmentInitator?c.slug.urlFragmentInitator:"#",urlFragmentAppend:"string"==typeof c.slug.urlFragmentAppend?c.slug.urlFragmentAppend:""},e.slug.built=(e.slug.preSlash?"/":"")+e.slug.urlFragmentInitator+e.slug.urlFragmentAppend,e.data={active:null,activeId:null,defaultId:null},"undefined"==typeof e.sections[0]&&e.throwError(0)}return _createClass(a,[{key:"init",value:function(){var a=this,b=a.findData(a.sections,"routerDefault","true");if(b){a.data.defaultId=b.dataset.routerId;var c=a.slugGet();a.writeLog("init",a.data.defaultId),a.moveTo(c)}else a.throwError(1)}},{key:"moveTo",value:function(a,b){var c=this;c.callback(c.events.before,[a,c]),c.writeLog("move",a);var d=function(a){var b=c.findData(c.sections,"routerId",a);return"undefined"!=typeof b?(c.data.activeId=a,c.data.active=b,!0):!1}(a);return d?(c.slugSet(c.data.activeId),c.callback(c.events.done,[c.data.active,c.data.activeId,c.getCurrentIndex(),c])):b?c.throwError(2):(c.writeLog("warning",a+" not found"),c.moveTo(c.data.defaultId,!0)),c.callback(c.events.always,[c.data.active,c.data.activeId,c.getCurrentIndex(),c]),d}},{key:"moveBy",value:function(a){var b=this,c=b.getCurrentIndex();"undefined"!=typeof b.sections[c+a]&&b.moveTo(b.sections[c+a].dataset.routerId)}},{key:"moveForward",value:function(){this.moveBy(1)}},{key:"moveBackward",value:function(){this.moveBy(-1)}},{key:"slugGet",value:function(a){var c=this;return b.href.lastIndexOf(this.slug.built)>-1?b.href.substr(b.href.lastIndexOf(c.slug.built)+(c.slug.preSlash?2:1)):a?void c.throwError(3):(c.slugInit(c.data.defaultId),c.slugGet(!0))}},{key:"slugSet",value:function(a){b.href=b.href.substr(0,b.href.lastIndexOf(this.slug.built)+this.slug.built.length)+a}},{key:"slugInit",value:function(a){b.href=b.href+this.slug.built+a}},{key:"getCurrentIndex",value:function(){var a=this;return a.getElementIndex(a.sections,a.data.active)}},{key:"getElementIndex",value:function(a,b){var c=void 0;return this.iterateDomNode(a,function(a,d){a===b&&(c=d)}),c}},{key:"findData",value:function(a,b,c){var d=void 0;return this.iterateDomNode(a,function(a){a.dataset[b]===c&&(d=a)}),d}},{key:"iterateDomNode",value:function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)}},{key:"callback",value:function(a,b){"function"==typeof a&&a.apply(this,b)}},{key:"writeLog",value:function(a,b){this.options.log}},{key:"throwError",value:function(a){var b=this;throw b.callback(b.events.fail,[a,b]),new Error("esRouter error: "+a)}}]),a}()}(window);