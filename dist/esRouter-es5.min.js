"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=a.location;a.esRouter=function(){function a(c,d){_classCallCheck(this,a);var e=this;e.events={before:d.before,done:d.done,fail:d.fail,always:d.always},e.options={ajax:c.ajax||!1,log:c.log||!1},e.slug={preSlash:c.slug.preSlash||!1,postSlash:c.slug.postSlash||!1,prepend:"string"==typeof c.slug.prepend?c.slug.prepend:"#",append:"string"==typeof c.slug.append?c.slug.append:"",get:function(a){return b.href.lastIndexOf(e.slug.built)>-1?b.href.substr(b.href.lastIndexOf(e.slug.built)+e.slug.built.length+(e.slug.preSlash?1:0)):a?void e.ut.log(1,1,1,this):(e.slug.init(e.data.defaultId),e.slug.get(!0))},set:function(a){b.href=b.href.substr(0,b.href.lastIndexOf(e.slug.built)+e.slug.built.length)+a},init:function(a){b.href=b.href+e.slug.built+a}},e.slug.built=(e.slug.preSlash?"/":"")+e.slug.prepend+e.slug.append,c.dataAttr=c.dataAttr||{},e.dom={getElements:function(a){for(var b=0;b<a.length;b++){var c=e.dom.dataAttr.buildAttr(e.dom.dataAttr.corePrefix,e.dom.dataAttr[a[b]]);e.dom.dataAttr.built[a[b]]=c,e.dom.elements[a[b]]=document.querySelectorAll("["+c[0]+"]")||[],e.ut.isDefined(e.dom.elements[a[b]])||e.ut.log(1,0,1,e.dom.elements[c[0]])}},dataAttr:{buildAttr:function(a,b){function c(a,b){return"data-"+a+"-"+b}function d(a,b){return a+b[0].toUpperCase()+b.substr(1)}return[c(a,b),d(a,b)]},types:["field","fieldDefault","link","pagination","source"],corePrefix:c.dataAttr.corePrefix||"router",field:c.dataAttr.field||"section",fieldDefault:c.dataAttr.fieldDefault||"default",link:c.dataAttr.link||"href",pagination:c.dataAttr.pagination||"pagin",source:c.dataAttr.pagination||"src",built:{}},elements:{}},e.data={active:null,activeId:null,defaultId:null,index:0},e.ut={getElementIndex:function(a,b){var c=void 0;return e.ut.each(a,function(a,d){a===b&&(c=d)}),c},findData:function(a,b,c){var d=void 0;return e.ut.each(a,function(a){a.dataset[b]===c&&(d=a)}),d},each:function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)},getAJAX:function(a,b){var c=this,d=new XMLHttpRequest;d.addEventListener("load",function(a){b(a.target.response)}),d.addEventListener("error",function(a){c.ut.log(1,3,0,d)}),d.open("GET",a),d.send()},callback:function(a,b){"function"==typeof a&&a.apply(this,b)},isDefined:function(a){return"undefined"!=typeof a},log:function(a,b,c,d){var f="esRouter: "+a+": "+b+"=>"+c+"= "+d;if(0===a)throw f;e.options.log}}}return _createClass(a,[{key:"init",value:function(){function a(){if(c.ut.isDefined(c.dom.elements.field)||c.ut.log(0,0,0,c),c.ut.isDefined(c.dom.elements.fieldDefault)){c.data.defaultId=c.dom.elements.fieldDefault[0].dataset[c.dom.dataAttr.built.field[1]];var a=c.slug.get();c.moveTo(a)}else c.ut.log(0,0,0,c)}function b(){c.ut.each(c.dom.elements.link,function(a){a.addEventListener("click",function(a){c.moveTo(a.target.dataset[c.dom.dataAttr.built.link[1]])})}),c.ut.each(c.dom.elements.pagination,function(a){a.addEventListener("click",function(a){c.moveBy(parseInt(a.target.dataset[c.dom.dataAttr.built.pagination[1]]))})})}var c=this;c.dom.getElements(c.dom.dataAttr.types),a(),b()}},{key:"moveTo",value:function(a,b){function c(a){var b=d.ut.findData(d.dom.elements.field,d.dom.dataAttr.built.field[1],a);return!!d.ut.isDefined(b)&&(d.data.activeId=a,d.data.active=b,d.data.index=d.getCurrentIndex(),!0)}var d=this;d.ut.callback(d.events.before,[a,d]);var e=c(a);return e?(d.slug.set(d.data.activeId),d.options.ajax?d.ut.getAJAX(d.data.active.dataset[d.dom.dataAttr.built.source[1]],function(a){d.data.active.innerHTML=a,d.ut.callback(d.events.done,[d.data.active,d.data.activeId,d.data.index,d,a])}):d.ut.callback(d.events.done,[d.data.active,d.data.activeId,d.data.index,d])):b?(d.ut.callback(d.events.fail,[a,d]),d.ut.log(0,1,1,this)):(d.ut.log(1,1,0,a),d.moveTo(d.data.defaultId,!0)),d.ut.callback(d.events.always,[d.data.active,d.data.activeId,d.data.index,d]),e}},{key:"moveBy",value:function(a){var b=this,c=b.data.index;return b.ut.isDefined(b.dom.elements.field[c+a])?b.moveTo(b.dom.elements.field[c+a].dataset[b.dom.dataAttr.built.field[1]]):(b.ut.log(2,1,0,a),!1)}},{key:"moveForward",value:function(){return this.moveBy(1)}},{key:"moveBackward",value:function(){return this.moveBy(-1)}},{key:"getCurrentIndex",value:function(){var a=this;return a.ut.getElementIndex(a.dom.elements.field,a.data.active)}}]),a}()}(window);