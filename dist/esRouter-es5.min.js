"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=a.location;a.esRouter=function(){function a(){var c=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,a);var e=this;e.events={before:d.before,done:d.done,fail:d.fail,always:d.always},e.options={ajax:c.ajax||!1,log:c.log||!1,autoBind:c.autoBind||!0},e.data={active:null,activeId:null,defaultId:null,index:0},e.slug={preSlash:c.slug.preSlash||!1,postSlash:c.slug.postSlash||!1,prepend:"string"==typeof c.slug.prepend?c.slug.prepend:"",append:"string"==typeof c.slug.append?c.slug.append:"",get:function(a,c){return e.slug.has()?b.href.substr(b.href.lastIndexOf(e.slug.built)+e.slug.built.length+(e.slug.preSlash?1:0)):void c(a)},has:function(){return b.href.lastIndexOf(e.slug.built)>-1},set:function(a){b.href=b.href.substr(0,b.href.lastIndexOf(e.slug.built)+e.slug.built.length)+a},create:function(a){b.href=b.href+e.slug.built+a},init:function(a,b){var c=e.slug.get(!1,function(b){return b?void a():(e.slug.create(e.data.defaultId),e.slug.get(!0))});b(c)},built:null},e.slug.built=(e.slug.preSlash?"/":"")+"#"+e.slug.prepend+e.slug.append,e.dom={corePrefix:c.corePrefix||"router",built:{},elements:{},base:{field:"section",fieldDefault:"default",link:"href",pagination:"pagin",source:"src"},getElements:function(a,b){e.ut.eachObject(e.dom.base,function(b,c,d){var f=e.dom.buildAttr(e.dom.corePrefix,e.dom.base[c]);e.dom.built[c]=f,e.dom.elements[c]=document.querySelectorAll("["+f[0]+"]")||[],e.ut.isDefined(e.dom.elements[c])||a(e.dom.elements[c])}),b()},buildAttr:function(a,b){function c(a,b){return"data-"+a+"-"+b}function d(a,b){return a+b[0].toUpperCase()+b.substr(1)}return[c(a,b),d(a,b)]},autoBind:function(){function a(a,b){e.ut.each(a,function(a){a.addEventListener("click",b)})}e.options.autoBind&&(a(e.dom.elements.link,function(a){e.moveTo(a.target.dataset[e.dom.built.link[1]])}),a(e.dom.elements.pagination,function(a){e.moveBy(parseInt(a.target.dataset[e.dom.built.pagination[1]]))}))}},e.router={init:function(a){e.dom.getElements(function(a){e.ut.log(1,0,1,a)},e.dom.autoBind),e.ut.isDefined(e.dom.elements.field)||e.ut.log(0,0,0,e),e.ut.isDefined(e.dom.elements.fieldDefault)?e.data.defaultId=e.dom.elements.fieldDefault[0].dataset[e.dom.built.field[1]]:e.ut.log(0,0,0,e),e.slug.init(function(){e.ut.log(1,1,1,e)},function(a){e.moveTo(a)})},move:function(a,b){function c(a){var b=e.ut.findData(e.dom.elements.field,e.dom.built.field[1],a);return!!e.ut.isDefined(b)&&(e.data.activeId=a,e.data.active=b,e.data.index=e.getCurrentIndex(),!0)}e.ut.callback(e.events.before,[a,e]);var d=c(a);return d?(e.slug.set(e.data.activeId),e.options.ajax?e.ut.getAJAX(e.data.active.dataset[e.dom.built.source[1]],function(a){e.data.active.innerHTML=a,e.ut.callback(e.events.done,[e.data.active,e.data.activeId,e.data.index,e,a])}):e.ut.callback(e.events.done,[e.data.active,e.data.activeId,e.data.index,e])):b?(e.ut.callback(e.events.fail,[a,e]),e.ut.log(0,1,1,this)):(e.ut.log(1,1,0,a),e.moveTo(e.data.defaultId,!0)),e.ut.callback(e.events.always,[e.data.active,e.data.activeId,e.data.index,e]),d}},e.ut={getElementIndex:function(a,b){var c=void 0;return e.ut.each(a,function(a,d){a===b&&(c=d)}),c},findData:function(a,b,c){var d=void 0;return e.ut.each(a,function(a){a.dataset[b]===c&&(d=a)}),d},each:function(a,b){for(var c=0,d=a.length;c<d;c++)b(a[c],c)},eachObject:function(a,b){for(var c=Object.keys(a),d=0,e=c.length;d<e;d++)b(a[c[d]],c[d],d)},getAJAX:function(a,b){var c=this,d=new XMLHttpRequest;d.addEventListener("load",function(a){b(a.target.response)}),d.addEventListener("error",function(a){c.ut.log(1,3,0,d)}),d.open("GET",a),d.send()},callback:function(a,b){"function"==typeof a&&a.apply(this,b)},isDefined:function(a){return"undefined"!=typeof a},log:function(a,b,c,d){var f="esRouter: "+a+": "+b+"=>"+c+"= "+d;if(0===a)throw f;e.options.log}}}return _createClass(a,[{key:"init",value:function(){var a=this;return a.router.init(),a}},{key:"moveTo",value:function(a){var b=this;return b.router.move(a,!1),b}},{key:"moveBy",value:function(a){var b=this,c=b.data.index;return b.ut.isDefined(b.dom.elements.field[c+a])?b.moveTo(b.dom.elements.field[c+a].dataset[b.dom.built.field[1]]):(b.ut.log(2,1,0,a),!1)}},{key:"moveForward",value:function(){return this.moveBy(1)}},{key:"moveBackward",value:function(){return this.moveBy(-1)}},{key:"getCurrentIndex",value:function(){var a=this;return a.ut.getElementIndex(a.dom.elements.field,a.data.active)}}]),a}()}(window);