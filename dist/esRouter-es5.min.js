"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){var b=a.location;a.esRouter=function(){function a(b,c){_classCallCheck(this,a);var d=this;d.events={before:c.before,done:c.done,fail:c.fail,always:c.always},d.options={ajax:b.ajax||!1,log:b.log||!1},d.slug={preSlash:b.slug.preSlash||!1,postSlash:b.slug.postSlash||!1,urlFragmentInitator:"string"==typeof b.slug.urlFragmentInitator?b.slug.urlFragmentInitator:"#",urlFragmentAppend:"string"==typeof b.slug.urlFragmentAppend?b.slug.urlFragmentAppend:""},d.slug.built=(d.slug.preSlash?"/":"")+d.slug.urlFragmentInitator+d.slug.urlFragmentAppend,b.dataAttr=b.dataAttr||{},d.dom={getElements:function(a){for(var b=0;b<a.length;b++){var c=d.dom.dataAttr.buildAttr(d.dom.dataAttr.corePrefix,d.dom.dataAttr[a[b]]);d.dom.dataAttr.built[a[b]]=c,d.dom.elements[a[b]]=document.querySelectorAll("["+c[0]+"]")||[]}},dataAttr:{buildAttr:function(a,b){function c(a,b){return"data-"+a+"-"+b}function d(a,b){return a+b[0].toUpperCase()+b.substr(1)}return[c(a,b),d(a,b)]},types:["section","sectionDefault","link","pagination"],corePrefix:b.dataAttr.corePrefix||"router",section:b.dataAttr.section||"section",sectionDefault:b.dataAttr.sectionDefault||"default",link:b.dataAttr.link||"href",pagination:b.dataAttr.pagination||"pagin",built:{}},elements:{}},d.data={active:null,activeId:null,defaultId:null}}return _createClass(a,[{key:"init",value:function(){var a=this;if(a.dom.getElements(a.dom.dataAttr.types),"undefined"==typeof a.dom.elements.section&&a.throwError.call(this,0),"undefined"!=typeof a.dom.elements.sectionDefault){a.data.defaultId=a.dom.elements.sectionDefault[0].dataset[a.dom.dataAttr.built.section[1]];var b=a.slugGet();a.writeLog("init",a.data.defaultId),a.moveTo(b)}else a.throwError.call(this,1)}},{key:"moveTo",value:function(a,b){var c=this;c.callback(c.events.before,[a,c]),c.writeLog("move",a);var d=function(a){var b=c.findData(c.dom.elements.section,c.dom.dataAttr.built.section[1],a);return"undefined"!=typeof b?(c.data.activeId=a,c.data.active=b,c.data.index=c.getCurrentIndex(),!0):!1}(a);return d?(c.slugSet(c.data.activeId),c.callback(c.events.done,[c.data.active,c.data.activeId,c.data.index,c])):b?c.throwError.call(this,2):(c.writeLog("warning",a+" not found"),c.moveTo(c.data.defaultId,!0)),c.callback(c.events.always,[c.data.active,c.data.activeId,c.data.index,c]),d}},{key:"moveBy",value:function(a){var b=this,c=b.data.index;"undefined"!=typeof b.dom.elements.section[c+a]&&b.moveTo(b.dom.elements.section[c+a].dataset[b.dom.dataAttr.built.section[1]])}},{key:"moveForward",value:function(){this.moveBy(1)}},{key:"moveBackward",value:function(){this.moveBy(-1)}},{key:"slugGet",value:function(a){var c=this;return b.href.lastIndexOf(this.slug.built)>-1?b.href.substr(b.href.lastIndexOf(c.slug.built)+c.slug.built.length+(c.slug.preSlash?1:0)):a?void c.throwError.call(this,3):(c.slugInit(c.data.defaultId),c.slugGet(!0))}},{key:"slugSet",value:function(a){b.href=b.href.substr(0,b.href.lastIndexOf(this.slug.built)+this.slug.built.length)+a}},{key:"slugInit",value:function(a){b.href=b.href+this.slug.built+a}},{key:"getCurrentIndex",value:function(){var a=this;return a.getElementIndex(a.dom.elements.section,a.data.active)}},{key:"getElementIndex",value:function(a,b){var c=void 0;return this.iterateDomNode(a,function(a,d){a===b&&(c=d)}),c}},{key:"findData",value:function(a,b,c){var d=void 0;return this.iterateDomNode(a,function(a){a.dataset[b]===c&&(d=a)}),d}},{key:"iterateDomNode",value:function(a,b){for(var c=0;c<a.length;c++)b(a[c],c)}},{key:"callback",value:function(a,b){"function"==typeof a&&a.apply(this,b)}},{key:"writeLog",value:function(a,b){this.options.log}},{key:"throwError",value:function(a){var b=this;throw b.callback(b.events.fail,[a,b]),new Error("esRouter error: "+a,this)}}]),a}()}(window);